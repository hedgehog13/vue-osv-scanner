<template>
  <div class="details-panel">
    <h3>Details for {{ vulnerability.package }}:</h3>
    <div class="vuln-list">
      <div class="vuln-card" v-for="(vuln, vIndex) in vulnerability.vulnerabilities" :key="vIndex">
        <div class="vuln-header">
          <span class="severity-badge" :class="getSeverityClass(vuln.severity)">
            {{ getSeverityLabel(vuln.severity) }}
          </span>
          <strong class="vuln-id">ID: {{ vuln.id }}</strong>
        </div>
        <p class="vuln-summary">{{ vuln.summary }}</p>
      </div>
    </div>
  </div>
</template>

<script lang="ts">
import { defineComponent, PropType } from 'vue'
import { VulnerabilityResult } from '@/services/osvService'
import { useVulnerabilityDetails } from './VulnerabilityDetails.ts'

export default defineComponent({
  name: 'VulnerabilityDetails',
  props: {
    vulnerability: {
      type: Object as PropType<VulnerabilityResult>,
      required: true,
    },
  },
  setup(props) {
    const { getSeverityClass, getSeverityLabel, vulnerabilityData } = useVulnerabilityDetails(props)

    return {
      getSeverityClass,
      getSeverityLabel,
      vulnerabilityData,
    }
  },
})
</script>

<style scoped src="./VulnerabilityDetails.css"></style>
